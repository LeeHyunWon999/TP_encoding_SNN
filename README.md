# TP_encoding_SNN

TP_encoding 방식을 SNN MLP에 적용하여 학습 잘 되는지 확인용

batch size만큼 묶어서 보내야 하므로 여기에도 GRU의 2차원 인코더를 사용하는 것이 나을 것으로 보임

- ver3 : 학습에 쓰이는 파라미터 등 추가, 얼리스탑은 valid_loss와 valid_auroc가 갱신되는 경우 초기화
 
`24. 07. 20. 특이사항 : 현재 사용중인 모델들
- ver2_poisson_2 : 1024 2층 쌓은 포아송
- ver3 : 추가 하이퍼파라미터 넣은 버전(단순 iter은 성능 좋지 않았으므로 filter 위주로 볼 것)
- ver3_filter_CNN : 필터계열 중 가장 성능 좋음


`24. 08. 22. 버전4 추가 시작
- 이전 버전들에서 계속 사용되는 모델들만 추려서 버전통일 : ver2_poisson_2(넘버링 제거), ver2_burst, ver3_filter_CNN_IF
- 랜덤시드 고정으로 성능 비교 일관성 향상
- 최고성능 나왔을 때 별도 폴더에 체크포인트 저장하는 기능 추가 : 근데 이제 옵션인
- Neu+ inference 시 뉴런의 초기화 방법이 잔차가 아닌 0이므로 해당 기능 변경
- threshold 파라미터 추가 : 가중치를 92로 지정하는 경우 학습되는 파라미터들이 전반적으로 높게 형성되는지에 대한 확인 필요(CNN 모델도 일관성을 위해 통일하는 편이 나아보임)
- 최종 추가 파라미터 : random_seed, checkpoint_path, checkpoint_save, threshold

'24. 08. 27. 버전5 추가
- 서버 이전으로 인한 버전업데이트, 따라서 신규 서버에선 버전5부터 사용할 것
- 최고성능 모델과 최신모델 따로 저장하기

'24. 09. 11. 버전5 업데이트
- 하이퍼파라미터 bias 추가 : 세 종류의 모델에 대해 bias 넣을지 여부 선택(conv1d도 bias 있다 하니 옵션으로 제어할 것)
- 단 모델명 등에 bias 여부를 집어넣진 않았음

'24. 09. 21. 버전5 업데이트(2)
- 리듬 데이터셋을 위한 모델 추가 : 3가지 모델들에 _rhythm 버전 추가
- 일단 추가만 해놓은 상태이며, poisson과 burst는 모델의 뉴런갯수를 리듬데이터에 맞출 필요가 있음

'24. 10. 10. 버전5 업데이트(3)
- 리듬 파일 완성
- LIF 레이어 사용한 포아송 파일 생성 (decay_input : 입력값을 바로 tau로 decay시킬 것인가, false로 지정할 것; tau는 1/tau로 decay시키므로 timestep과 동기화시킬 것)
- 내친김에 filter CNN도 LIF로 실험 돌려보기(정확도 적절히 잘 나오면 리듬도 시도할 것)

'24. 10. 28. 버전5 업데이트(4)
- 리듬 : 데이터로더에서 0~1 normalize 안되는 점 수정, 다른 모든 rhythm 파일에 적용
- poisson lowProbability 추가 : 원하는 확률값으로 낮추도록 데이터로더 수정, 나중에 필요시 config 파일 추가 예정이지만 일단 일반 poisson과 config 파일 공유

'24. 11. 05. 버전5 업데이트(5)
- LIF : 양의 가중치로 학습하도록 초기 가중치 지정 및 음의 가중치 패널티 loss 추가
- 추가 파라미터 - negative_penalty_alpha : 음의 가중치 값들에 대해 패널티 loss화 하는 하이퍼파라미터 계수
- 양의 초기화 변경점   
    - 양수 초기화
    - train, valid 모두 음수 패널티 항 추가
    - config 파일에 음수패널티 계수 추가, .py에도 추가
- ver5 모든 파일 gpu 번호도 config로 옮김

'24. 12. 20. 버전6 추가
- k-fold cross validation 코드 추가로 적용
- 단, test 데이터를 위한 용도를 위한 경우 버전 5 복사해다가 파일명 뒤에 _final_test 붙여서 새로 만들 것



### 버전업마다 파일 변경할 점
- config 파일 : model_name 변수명에 버전업
- 저장경로 바뀌는 경우 이것도 config 파일에서 수정할 것
- 얼리스탑과 체크포인트 저장이 동시에 활성화된 경우 최고성능과 최종에포크 모델이 전부 저장되지만, 얼리스탑이 꺼진 경우 최종에포크 모델만 저장됨에 유의!
- 추가 파라미터 : early_stop_enable

### 나중에 할 일
- 리듬 데이터셋 입수하는 경우 그쪽에선 cross-validation도 추가할 것